<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Inconsolata);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .footnote {
          position:absolute;
          bottom: 3em;
      }
      .red {
          color: red;
      }
      .remark-code, .remark-inline-code { font-family: 'Incosolata'; }
      .remark-code{
          border-radius:10px;
      }
      .remark-slide-content{
          background-size: cover;
      }
      .remark-code-line-highlighted {
          background-color: #073642;
          nop:#eee8d5;
      }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle
background-image: url(img/wrc-wales-rally-gb-loeb-01.jpg)

# Tests Tout-Terrain
## (Python édition)
---
# Big ups:
## Pyconf
## Yaal
---

# Agenda

1. Les tests
2. Les terrains dangereux
3. Les outils

---
# Les tests?
- Ca sert à rien!
- Les methodes formelles
Mais pour l'instant...

---
# Les tests?
- Specifications
- Fonctionnalités
- Performances
- Sécurité

--
# Les tests?
Deux approches:
- Black box
- White box

--
# Les tests?
1. Unitaire (bas niveau)
2. Intégration (haut niveau)
3. Fonctionnel (système (aka ca fonctionne chez moi))
4. Acceptation (recette, humain...)
.footnote[Selon le CFTL (www.cftl.fr)]
---

# Les tests?
- Les tests de performances
    - Volume
    - Durée
    - Concurence
    - Temps de récupération
- Les tests de sécurités
    - Accès (page/mémoire/disque)
    - Entrées
- Les tests d'acceptations
    - Alpha/beta
    - Recette
    - Usabilité (aveugle, senior...)
Et la liste ne doit pas être exhaustive!!!
---

# Les tests unitaires

```python
def super_additionneur(param1, param2):
    return float(param1) + float(param2)

def test_super_additionneur():
    assert super_additionneur(1, 1) == 2
    assert super_additionneur(3, 5) == 8
    assert super_additionneur(1, -1) == 0
    assert super_additionneur(2.5, 5.) == 7.5
*   assert super_additionneur("vingt", " et un") == "vingt et un"
    assert super_additionneur("1", "1") == 2
    assert super_additionneur("2.5", 5) == 7.5
```
.footnote[.red[*] Exemple sametmax.com]
???
Exemple sametmax.com
---

# Les tests fonctionnels

```python
def super_additionneur(param1, param2):
    return param1 + param2

def test_addition_de_deux_nombres():
    #Arrange
    app = TestApp(application)

    #Act
    response = app.post_json('/super-additionneur', dict(param1=1, param2=2))

    #Assert
    assert response.status == '200 OK'
    assert response.content_type == 'application/json'
    assert response.json == { "result": 3 }

```
---
background-image: url(img/wrc-sweeden.jpg)

# Les terrains dangereux
- BDD
- Temps
- Fichiers
- Réseaux
- Concurence
---
background-image: url(img/giphy.gif)
# BDD
- En mémoire!
---
# Temps
- datetime: monkeypatch
- freezegun

---
# Fichiers
- Mock!
- Fake!
---
# Réseaux
- Mock!
- Fake!
---
# Concurence
- Test run en parralèle
- Multiple threads!
---
# Les outils
- pytest , nose , unittest
- Mock, Hypothesis
- Tox
---
# Tox
tox.ini

```ini
[tox]
envlist = py27, py35
[testenv]
*deps=
    pytest
    webtest
    werkzeug
commands=pytest
```
---
Vous avez tout vu!
---
Questions?



    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
        var slideshow = remark.create({
            highlightLanguage: 'python',
            highlightStyle: 'solarized-dark',
            highlightLines: true,
        });
    </script>
  </body>
</html>
